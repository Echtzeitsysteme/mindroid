language: none

build:
  pre_ci_boot:
    image_name: echtzeitsysteme/mindroid
    image_tag: latest
    pull: true

  ci:
    - cd "impl"
    # Build Android application
    - cd "./androidApp"
    - bash ./gradlew clean test assemble
    - cd ..
    # Build EV3 application
    - cd "./ev3App"
    - bash ../androidApp/gradlew clean test assemble
    - cd ..
    # Build server application
    - cd "./serverApp"
    - bash ../androidApp/gradlew clean test assemble
    - cd ..
    # Provide test reports to Shippable
    - cp ./androidApp/api/build/test-results/TEST-*.xml /root/src/github.com/Echtzeitsysteme/mindroid/shippable/testresults
    - cp ./androidApp/app/build/test-results/debug/TEST-*.xml /root/src/github.com/Echtzeitsysteme/mindroid/shippable/testresults
    - cp ./androidApp/app/build/test-results/release/TEST-*.xml /root/src/github.com/Echtzeitsysteme/mindroid/shippable/testresults
    - cp ./include/interRobotMessages/build/test-results/TEST-*.xml /root/src/github.com/Echtzeitsysteme/mindroid/shippable/testresults
   
integrations:
  # See http://docs.shippable.com/ci/email-notifications/
  notifications:
    - integrationName: email
      type: email
      sendConsoleLogs: true
      recipients:
        --last_committer
        - roland.kluge@es.tu-darmstadt.de
